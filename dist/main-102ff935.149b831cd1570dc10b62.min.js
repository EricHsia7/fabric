"use strict";(self.webpackChunkfabric=self.webpackChunkfabric||[]).push([[743],{48:(t,e,a)=>{a.d(e,{default:()=>P});var n={};function o(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||r(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){if(t){if("string"==typeof t)return i(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}a.r(n);var h=document.querySelector("#fabric");h.getContext("2d"),document.querySelector("#vector_fabric"),document.querySelector("#vector_fabric g#pen"),Math.log(window.devicePixelRatio),Math.log(Math.pow(2,.4)),window.innerWidth,window.innerHeight;function c(t,e){var a=t.map((function(t){return t.x})),n=t.map((function(t){return t.y}));registration[e]={x1:Math.min.apply(Math,o(a)),y1:Math.min.apply(Math,o(n)),x2:Math.max.apply(Math,o(a)),y2:Math.max.apply(Math,o(n)),points:t,id:e,hidden:!1}}Math.min(Math.log(4)/Math.log(Math.pow(10,.88)),.7);var l=[];function u(t,e){0===t.length&&0===e.length||(l.push({addition:t,deletion:e}),0)}var s={37:1,38:1,39:1,40:1},f=!1,p="onwheel"in document.createElement("div")?"wheel":"mousewheel";function d(t){t.preventDefault()}function w(t){if(s[t.keyCode])return d(t),!1}function y(){window.addEventListener("DOMMouseScroll",d,!1),window.addEventListener(p,d,f),window.addEventListener("touchmove",d,f),window.addEventListener("keydown",w,!1)}function M(){window.removeEventListener("DOMMouseScroll",d,!1),window.removeEventListener(p,d,f),window.removeEventListener("touchmove",d,f),window.removeEventListener("keydown",w,!1)}function x(t,e,a,n){return{x:parseFloat((t+Math.cos(n)*a).toFixed(10)),y:parseFloat((e+Math.sin(n)*a).toFixed(10)),radian:n,degree:n*(180/Math.PI),radius:a}}function v(t,e){for(var a=[],n=/((m|M)\s{0,1}([0-9\.\-]*)(\s|\,)([0-9\.\-]*)|(l|L)\s{0,1}([0-9\.\-]*)(\s|\,)([0-9\.\-]*)|(h|H)\s{0,1}([0-9\.\-]*)|(v|V)\s{0,1}([0-9\.\-]*)|(c|C)\s{0,1}([0-9\.\-]*)(\s|\,)([0-9\.\-]*)[\,\s]{1,2}([0-9\.\-]*)(\s|\,)([0-9\.\-]*)[\,\s]{1,2}([0-9\.\-]*)(\s|\,)([0-9\.\-]*)|(s|S)\s{0,1}([0-9\.\-]*)(\s|\,)([0-9\.\-]*)[\,\s]{1,2}([0-9\.\-]*)(\s|\,)([0-9\.\-]*)|(q|Q)\s{0,1}([0-9\.\-]*)(\s|\,)([0-9\.\-]*)[\,\s]{1,2}([0-9\.\-]*)(\s|\,)([0-9\.\-]*)|(t|T)\s{0,1}([0-9\.\-]*)(\s|\,)([0-9\.\-]*)|(Z|z))/gm;null!==(m=n.exec(t));)m.index===n.lastIndex&&n.lastIndex++,m.forEach((function(t,n){if("M"===t){var o=parseFloat(m[n+1]),r=parseFloat(m[n+3]);a.push({x:o,y:r})}if("L"===t){o=parseFloat(m[n+1]),r=parseFloat(m[n+3]);var i=(M=a[a.length-1]||{x:null,y:null}).x,h=M.y;if(null===i||null===h)a.push({x:o,y:r});else for(var c=Math.sqrt(Math.pow(o-i,2)+Math.pow(r-h,2)),l=0;l<c/e;l++){var u=i+l/(c/e)*(o-i),s=h+l/(c/e)*(r-h);a.push({x:u,y:s})}}if("H"===t){o=m[n+1],r=0,i=(M=a[a.length-1]||{x:null,y:null}).x,h=M.y;if(null===i||null===h)a.push({x:o,y:r});else for(c=Math.abs(o-i),l=0;l<c/e;l++){u=i+l/(c/e)*(o-i);a.push({x:u,y:h})}}if("V"===t){o=0,r=m[n+1],i=(M=a[a.length-1]||{x:null,y:null}).x,h=M.y;if(null===i||null===h)a.push({x:o,y:r});else for(c=Math.abs(r-h),l=0;l<c/e;l++){u=h+l/(c/e)*(r-h);a.push({x:i,y:u})}}if("C"===t){var f=m[n+1],p=m[n+3],d=m[n+4],w=m[n+6];o=m[n+7],r=m[n+9],i=(M=a[a.length-1]||{x:null,y:null}).x,h=M.y;if(null===i||null===h)a.push({x:o,y:r});else for(c=Math.sqrt(Math.pow(o-i,2)+Math.pow(r-h,2)),l=0;l<c/e;l++){var y=Math.min(Math.max(l/(c/e),0),1);u=Math.pow(1-y,3)*i+3*Math.pow(1-y,2)*y*f+3*(1-y)*Math.pow(y,2)*d+Math.pow(y,3)*o,s=Math.pow(1-y,3)*h+3*Math.pow(1-y,2)*y*p+3*(1-y)*Math.pow(y,2)*w+Math.pow(y,3)*r;a.push({x:u,y:s})}}if("S"===t){d=m[n+1],w=m[n+3],o=m[n+4],r=m[n+6],i=(M=a[a.length-1]||{x:null,y:null}).x,h=M.y;if(null===i||null===h)a.push({x:o,y:r});else for(c=Math.sqrt(Math.pow(o-i,2)+Math.pow(r-h,2)),l=0;l<c/e;l++){y=Math.min(Math.max(l/(c/e),0),1),u=Math.pow(1-y,3)*i+3*Math.pow(1-y,2)*y*(2*i-d)+3*(1-y)*Math.pow(y,2)*d+Math.pow(y,3)*o,s=Math.pow(1-y,3)*h+3*Math.pow(1-y,2)*y*(2*h-w)+3*(1-y)*Math.pow(y,2)*w+Math.pow(y,3)*r;a.push({x:u,y:s})}}if("Q"===t){var M;f=parseFloat(m[n+1]),p=parseFloat(m[n+3]),o=parseFloat(m[n+4]),r=parseFloat(m[n+6]),i=(M=a[a.length-1]||{x:null,y:null}).x,h=M.y;if(null===i||null===h)a.push({x:o,y:r});else for(c=Math.sqrt(Math.pow(o-i,2)+Math.pow(r-h,2)),l=0;l<c/e;l++){y=Math.min(Math.max(l/(c/e),0),1),u=Math.pow(1-y,2)*i+2*(1-y)*y*f+Math.pow(y,2)*o,s=Math.pow(1-y,2)*h+2*(1-y)*y*p+Math.pow(y,2)*r;a.push({x:u,y:s})}}if("T"===t)o=m[n+1],r=m[n+3]}));return a}var _=a(429).v4;function g(t,e,a){var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttributeNS(null,"d",t),n.setAttributeNS(null,"stroke-width",pen_width_base),n.setAttributeNS(null,"stroke",e),n.setAttributeNS(null,"fill","none"),n.setAttributeNS(null,"stroke-linecap","round"),n.setAttributeNS(null,"fill-rule","nonzero"),n.setAttributeNS(null,"id",_()),(a=document.querySelector("#"+a)||svg_canvas_pen_layer).appendChild(n)}function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function D(t){M();var e=[];for(var a in t.changedTouches)t.changedTouches.hasOwnProperty(a)&&"object"===b(t.changedTouches[a])&&e.push(t.changedTouches[a]);var o,r,i=e.filter((function(t){return t.identifier===touch_point_identity}))[0];if(i){if(touchData.length>=2){touchData[touchData.length-1];touchData.push({x:i.clientX-offsetX,y:i.clientY-offsetY,force:i.force||0,time_stamp:(new Date).getTime(),angle:touchData[touchData.length-1].angle}),touchData_a.push({x:i.clientX-offsetX,y:i.clientY-offsetY}),touchData_b.push({x:i.clientX-offsetX,y:i.clientY-offsetY}),touchData=touchData.map((function(t){return Object.assign(t,{x:t.x-move_offset_x,y:t.y-move_offset_y})})),touchData_a=touchData_a.map((function(t){return Object.assign(t,{x:t.x-move_offset_x,y:t.y-move_offset_y})})),touchData_b=touchData_b.map((function(t){return Object.assign(t,{x:t.x-move_offset_x,y:t.y-move_offset_y})}))}(0,n.updatePenPath)();var h=(o=document.createElementNS("http://www.w3.org/2000/svg","g"),r="g-"+_(),o.setAttributeNS(null,"id",r),svg_canvas_pen_layer.appendChild(o),r);g(currentPath.a,pen_color,h),g(currentPath.b,pen_color,h),g(currentPath.c,pen_color,h);var l=v(currentPath.a,3),s=v(currentPath.b,3),f=v(currentPath.c,3);c(l.concat(s).concat(f),h),u([h],[]),ctx.clearRect(0,0,canvas.width,canvas.height)}}var S=a(597);a(483);window.fabric_initialize=function(){h.addEventListener("touchstart",(function(t){(function(t){y();var e=t.touches[0];touchData=[],touchData_a=[],touchData_b=[],touch_point_identity=e.identifier,e.force?(force_weight=.5,speed_weight=-.2):(force_weight=.1,speed_weight=.2),touchData.push({x:e.clientX-offsetX,y:e.clientY-offsetY,force:e.force||0,time_stamp:(new Date).getTime(),angle:0}),touchData_a.push({x:e.clientX-offsetX,y:e.clientY-offsetY}),touchData_b.push({x:e.clientX-offsetX,y:e.clientY-offsetY});var a=touchData[touchData.length-1];ctx.beginPath(),ctx.arc(a.x*scale,a.y*scale,.5*pen_width_base*scale,0,2*Math.PI),ctx.fillStyle=pen_color,ctx.fill(),ctx.closePath()})(t)}),!1),h.addEventListener("touchmove",(function(t){(function(t){var e=[];for(var a in t.touches)t.touches.hasOwnProperty(a)&&"object"===b(t.touches[a])&&e.push(t.touches[a]);var o=e.filter((function(t){return t.identifier===touch_point_identity}))[0];if(o){var r,i=touchData[touchData.length-1]||{x:o.clientX-offsetX,y:o.clientY-offsetY,force:o.force||0,time_stamp:(new Date).getTime(),angle:0},h=touchData[touchData.length-2]||i,c=h.x,l=h.y,u=i.x,s=i.y;r=u-c==0?s>l?Math.PI/2:s<l?-Math.PI/2:0:Math.atan2(s-l,u-c),touchData.push({x:o.clientX-offsetX,y:o.clientY-offsetY,force:o.force||0,time_stamp:(new Date).getTime(),angle:r});var f=Math.sqrt(Math.pow(i.x-h.x,2)+Math.pow(i.y-h.y,2))/(i.time_stamp-h.time_stamp),p=Math.min(Math.max(pen_width_base*Math.pow(i.force,.4)*(force_weight/(force_weight+speed_weight))*.5+pen_width_base*Math.max(.3,Math.log(f)/Math.log(1.8))*(speed_weight/(force_weight+speed_weight))*.5,0),.7*pen_width_base)||0,d=x(o.clientX-offsetX,o.clientY-offsetY,p,r-Math.PI/2),m=x(o.clientX-offsetX,o.clientY-offsetY,p,r+Math.PI/2);touchData_a.push({x:d.x,y:d.y}),touchData_b.push({x:m.x,y:m.y}),ctx.clearRect(0,0,canvas.width,canvas.height),(0,n.updatePenPath)()}})(t)}),!1),h.addEventListener("touchend",(function(t){D(t),saveContent()}),!1),window.addEventListener("resize",(function(){resizeFabric()})),S.addTo(".tools_container button","#fff",370),resizeFabric(),loadContent()};const P=window.fabric_initialize}}]);
//# sourceMappingURL=main-102ff935.149b831cd1570dc10b62.min.js.map